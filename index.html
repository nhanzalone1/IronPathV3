<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>IronPath Pro</title>
<style>
  /* --- 1. CORE VARIABLES --- */
  :root { --bg: #0f0f13; --card: #1a1a24; --text: #ffffff; --accent: #ff4757; --success: #2ed573; --dim: #888; }
  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body { margin: 0; padding: 0; background-color: var(--bg); color: var(--text); font-family: -apple-system, system-ui, sans-serif; overflow-x: hidden; padding-bottom: 90px; }
  
  /* --- 2. UTILS --- */
  .hidden { display: none !important; }
  .btn { width: 100%; padding: 16px; border: none; border-radius: 12px; font-weight: 800; cursor: pointer; text-transform: uppercase; font-size: 14px; margin-top: 10px; transition: 0.1s; }
  .btn:active { transform: scale(0.98); }
  .btn-main { background: linear-gradient(135deg, #ff4757, #ff6b81); color: white; }
  .btn-sec { background: #333; color: white; border: 1px solid #444; }
  .btn-danger { background: #2a1a1a; color: #ff4757; border: 1px solid #522; font-size: 12px; padding: 10px; }
  h1 { text-align: center; margin: 25px 0 5px; font-size: 26px; letter-spacing: -1px; }
  .sub { text-align: center; color: var(--dim); font-size: 11px; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 25px; }
  input { background: #121212; border: 1px solid #333; color: white; padding: 14px; border-radius: 10px; width: 100%; font-size: 16px; margin-bottom: 10px; }
  input:focus { outline:none; border-color: var(--accent); }

  /* --- 3. LAYOUT --- */
  .view { padding: 20px; max-width: 600px; margin: 0 auto; animation: fade 0.3s; }
  @keyframes fade { from{opacity:0; transform:translateY(5px)} to{opacity:1; transform:translateY(0)} }

  /* --- 4. PROGRAM STYLES --- */
  .week { background: var(--card); border-radius: 12px; margin-bottom: 15px; border: 1px solid #333; overflow: hidden; }
  .week-head { display: flex; justify-content: space-between; padding: 15px; background: #222; border-bottom: 1px solid #333; font-weight: bold; }
  .day-row { display: flex; justify-content: space-between; padding: 15px; border-bottom: 1px solid #222; align-items: center; }
  .tag { font-size: 9px; padding: 3px 6px; border-radius: 4px; color: black; font-weight: 800; margin-left: 8px; text-transform: uppercase; }
  .tag-h { background: #ff4757; } .tag-l { background: #2ed573; } .tag-m { background: #ffa502; }
  .completed { text-decoration: line-through; opacity: 0.5; color: var(--success); }
  .chk { width: 22px; height: 22px; border: 2px solid #555; border-radius: 50%; margin-right: 12px; display: inline-block; }
  .completed .chk { background: var(--success); border-color: var(--success); }

  /* --- 5. LOG STYLES --- */
  .split-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: #222; padding: 15px; border-radius: 12px; border: 1px solid #333; }
  .day-card { display: flex; justify-content: space-between; align-items: center; background: var(--card); padding: 18px; border-radius: 12px; margin-bottom: 12px; border: 1px solid #333; cursor: pointer; }
  .day-card:active { border-color: var(--accent); }
  
  .ex-card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #333; position: relative; }
  .ex-head { display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: bold; font-size: 16px; padding-right: 25px; }
  .del-btn { position: absolute; top: 15px; right: 15px; color: #555; background: none; border: none; font-size: 16px; padding: 0; margin: 0; width: auto; cursor: pointer; }
  .del-btn:active { color: red; }
  .hist-text { font-size: 11px; color: var(--success); margin-bottom: 10px; display: block; font-weight: bold; }
  .input-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

  /* --- 6. CUSTOM MODAL (NO GOOGLE POPUPS) --- */
  #modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(3px); }
  .modal-box { background: #1e1e1e; padding: 25px; border-radius: 15px; width: 85%; max-width: 350px; border: 1px solid #444; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transform: translateY(0); transition: 0.2s; }
  .modal-title { margin-top: 0; color: white; font-size: 18px; }
  
  /* --- 7. TOOLS & NAV --- */
  .tool-box { background: var(--card); padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #333; text-align: center; }
  .timer-display { font-size: 45px; font-weight: 900; margin: 15px 0; font-variant-numeric: tabular-nums; }
  .plate { padding: 6px 12px; border-radius: 6px; color: black; font-weight: bold; font-size: 12px; display: inline-block; margin: 2px; }
  .nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 80px; background: #181818; border-top: 1px solid #333; display: grid; grid-template-columns: 1fr 1fr 1fr; z-index: 1000; padding-bottom: 20px; }
  .nav-btn { background: none; border: none; color: #666; font-size: 10px; font-weight: bold; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; }
  .nav-btn.active { color: var(--accent); }
  .nav-icon { font-size: 22px; margin-bottom: 5px; }

</style>
</head>
<body>

<div id="modal-overlay">
  <div class="modal-box">
    <h3 id="modal-title" class="modal-title">Input</h3>
    <input type="text" id="modal-input" placeholder="...">
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:15px;">
      <button class="btn btn-sec" onclick="closeModal()" style="margin:0">CANCEL</button>
      <button class="btn btn-main" id="modal-ok" style="margin:0">SAVE</button>
    </div>
  </div>
</div>

<div id="view-program" class="view">
  <h1>IRONPATH</h1>
  <p class="sub">ENGINE</p>
  <div style="background:#222; padding:15px; border-radius:12px; border:1px solid #333; margin-bottom:20px;">
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <input type="number" id="w" placeholder="Weight (lbs)">
        <input type="number" id="r" placeholder="Reps">
    </div>
    <button class="btn btn-main" onclick="genProgram()">Generate 8-Week Cycle</button>
  </div>
  <div id="schedule-area"></div>
</div>

<div id="view-log" class="view hidden">
  <h1>TRAINING LOG</h1>
  <p class="sub">CUSTOM BUILDER</p>

  <div id="split-manager">
      <div id="my-split-list"></div>
      <button class="btn btn-sec" style="border-style:dashed; color:#888;" onclick="promptAddDay()">+ ADD FOLDER (e.g. 'Push')</button>
      
      <div style="margin-top:40px; border-top:1px solid #333; padding-top:20px;">
        <p style="text-align:center; color:#555; font-size:12px;">PRESETS (ADDS FOLDERS ONLY)</p>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
           <button class="btn btn-sec" style="margin:0; font-size:11px;" onclick="loadPreset('PPL')">LOAD PPL</button>
           <button class="btn btn-sec" style="margin:0; font-size:11px;" onclick="loadPreset('UL')">LOAD UPPER/LOWER</button>
        </div>
      </div>
  </div>

  <div id="session-logger" class="hidden">
      <div style="display:flex; align-items:center; margin-bottom:15px;">
        <button class="btn btn-sec" onclick="closeSession()" style="width:auto; margin:0; padding:10px 15px;">‚Üê</button>
        <h2 id="session-title" style="margin:0 0 0 15px; color:var(--accent); font-size:20px;"></h2>
      </div>
      
      <div id="exercises-container"></div>
      
      <button class="btn btn-sec" style="border-style:dashed; margin-top:20px;" onclick="promptAddEx()">+ ADD EXERCISE</button>
      <button class="btn btn-main" style="margin-top:30px;" onclick="finishSession()">FINISH & SAVE LOG</button>
  </div>
</div>

<div id="view-tools" class="view hidden">
  <h1>TOOLS</h1>
  <p class="sub">UTILITIES</p>
  <div class="tool-box">
      <h3 style="margin:0 0 15px 0; color:var(--accent)">REST TIMER</h3>
      <div class="timer-display" id="t-disp">00:00</div>
      <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:5px;">
          <button class="btn btn-sec" onclick="startTimer(90)">90s</button>
          <button class="btn btn-sec" onclick="startTimer(180)">3m</button>
          <button class="btn btn-sec" onclick="startTimer(300)">5m</button>
      </div>
      <button class="btn btn-main" style="margin-top:10px; background:#333;" onclick="clearInterval(timer);document.getElementById('t-disp').innerText='00:00'">STOP</button>
  </div>
  <div class="tool-box">
      <h3 style="margin:0 0 15px 0; color:var(--accent)">PLATE CALC</h3>
      <input type="number" id="pIn" placeholder="Target Weight (45+ lbs)">
      <button class="btn btn-main" style="background:var(--success); color:black;" onclick="calcPlates()">CALCULATE</button>
      <div id="pOut" style="margin-top:15px;"></div>
  </div>
  <div class="tool-box" style="border-color:#444;">
      <button class="btn btn-danger" onclick="nuke()">FACTORY RESET APP</button>
  </div>
</div>

<div class="nav">
    <button class="nav-btn active" onclick="switchTab('program', this)"><span class="nav-icon">üìä</span> PROGRAM</button>
    <button class="nav-btn" onclick="switchTab('log', this)"><span class="nav-icon">üìù</span> LOG</button>
    <button class="nav-btn" onclick="switchTab('tools', this)"><span class="nav-icon">‚öí</span> TOOLS</button>
</div>

<script>
// --- STATE MANAGEMENT ---
let myDays = JSON.parse(localStorage.getItem('myDays') || '[]'); // ["Push", "Pull"]
let myExs = JSON.parse(localStorage.getItem('myExs') || '{}');   // { "Push": ["Bench"] }
let history = JSON.parse(localStorage.getItem('liftHistory') || '{}');

// --- INIT ---
renderDays();

// --- TABS ---
function switchTab(id, btn) {
    document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
    document.getElementById('view-'+id).classList.remove('hidden');
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
}

// --- LOG: FOLDER SYSTEM ---
function renderDays() {
    const list = document.getElementById('my-split-list');
    list.innerHTML = "";
    if(myDays.length === 0) list.innerHTML = "<div style='text-align:center; color:#555; margin:30px 0;'>No folders yet.<br>Create one or load a preset.</div>";
    
    myDays.forEach((day, idx) => {
        list.innerHTML += `
        <div class="day-card" onclick="openSession('${day}')">
            <b>${day}</b>
            <span style="font-size:12px; color:#666;">${(myExs[day]||[]).length} Exercises ‚ñ∂</span>
        </div>`;
    });
}

function promptAddDay() {
    openModal("Name your Folder", "e.g. Chest Day", (val) => {
        if(val && !myDays.includes(val)) {
            myDays.push(val);
            saveData();
            renderDays();
        }
    });
}

function loadPreset(type) {
    if(myDays.length > 0 && !confirm("This will add folders to your list. Continue?")) return;
    let add = [];
    if(type === 'PPL') add = ["Push", "Pull", "Legs"];
    if(type === 'UL') add = ["Upper", "Lower"];
    
    add.forEach(d => { if(!myDays.includes(d)) myDays.push(d); });
    saveData();
    renderDays();
}

// --- LOG: EXERCISE SYSTEM ---
let activeDay = "";

function openSession(day) {
    activeDay = day;
    document.getElementById('split-manager').classList.add('hidden');
    document.getElementById('session-logger').classList.remove('hidden');
    document.getElementById('session-title').innerText = day;
    renderExs();
}

function closeSession() {
    document.getElementById('session-logger').classList.add('hidden');
    document.getElementById('split-manager').classList.remove('hidden');
}

function renderExs() {
    const con = document.getElementById('exercises-container');
    con.innerHTML = "";
    const list = myExs[activeDay] || [];
    
    if(list.length === 0) con.innerHTML = "<div style='text-align:center; color:#555; padding:20px;'>Empty folder.<br>Add an exercise to start.</div>";

    list.forEach((ex, idx) => {
        const last = history[ex] || "No history";
        con.innerHTML += `
        <div class="ex-card">
            <div class="ex-head">
                <span>${ex}</span>
                <button class="del-btn" onclick="delEx(${idx})">‚úï</button>
            </div>
            <span class="hist-text">LAST: ${last}</span>
            <div class="input-group">
                <input type="number" placeholder="Lbs" id="w-${idx}">
                <input type="number" placeholder="Reps" id="r-${idx}">
            </div>
        </div>`;
    });
}

function promptAddEx() {
    openModal("Add Exercise", "e.g. Bench Press", (val) => {
        if(val) {
            if(!myExs[activeDay]) myExs[activeDay] = [];
            myExs[activeDay].push(val);
            saveData();
            renderExs();
        }
    });
}

function delEx(idx) {
    if(confirm("Remove this exercise?")) {
        myExs[activeDay].splice(idx, 1);
        saveData();
        renderExs();
    }
}

function finishSession() {
    const list = myExs[activeDay] || [];
    let savedCount = 0;
    list.forEach((ex, idx) => {
        const w = document.getElementById(`w-${idx}`).value;
        const r = document.getElementById(`r-${idx}`).value;
        if(w && r) {
            history[ex] = `${w} lbs x ${r}`;
            savedCount++;
        }
    });
    localStorage.setItem('liftHistory', JSON.stringify(history));
    alert(savedCount > 0 ? "Log Saved!" : "Session closed (Nothing logged).");
    closeSession();
}

function saveData() {
    localStorage.setItem('myDays', JSON.stringify(myDays));
    localStorage.setItem('myExs', JSON.stringify(myExs));
}

// --- MODAL SYSTEM ---
function openModal(title, place, callback) {
    const m = document.getElementById('modal-overlay');
    const inp = document.getElementById('modal-input');
    const btn = document.getElementById('modal-ok');
    
    document.getElementById('modal-title').innerText = title;
    inp.value = "";
    inp.placeholder = place;
    m.style.display = 'flex';
    inp.focus();
    
    // Clear old listeners
    let newBtn = btn.cloneNode(true);
    btn.parentNode.replaceChild(newBtn, btn);
    
    newBtn.addEventListener('click', () => {
        m.style.display = 'none';
        callback(inp.value);
    });
}
function closeModal() { document.getElementById('modal-overlay').style.display = 'none'; }

// --- TOOLS ---
let timer;
function startTimer(s) { clearInterval(timer); const end = Date.now() + s*1000; disp(s); timer = setInterval(()=>{const r=Math.round((end-Date.now())/1000); if(r<0){clearInterval(timer);document.getElementById('t-disp').innerText="DONE";return;} disp(r);},1000); }
function disp(s){const m=Math.floor(s/60);const r=s%60;document.getElementById('t-disp').innerText=`${m}:${r<10?'0':''}${r}`;}
function calcPlates() {
    const w = parseFloat(document.getElementById('pIn').value); const div = document.getElementById('pOut');
    if(!w || w<45) { div.innerText="45+ Only"; return; }
    let r=(w-45)/2, h=""; [45,35,25,10,5,2.5].forEach(s=>{while(r>=s){ let c="#eee";if(s==45)c="#45aaf2";if(s==25)c="#2ed573"; h+=`<span class="plate" style="background:${c}">${s}</span> `;r-=s; }});
    div.innerHTML = h + `<div style='margin-top:10px; color:#2ed573; font-weight:bold'>Load ${(w-45)/2}/side</div>`;
}
function nuke() { if(confirm("DELETE ALL DATA?")) { localStorage.clear(); location.reload(); } }

// --- ENGINE ---
function genProgram() {
    const w = parseFloat(document.getElementById('w').value); const r = parseFloat(document.getElementById('r').value); if(!w || !r) return;
    const rnd=n=>Math.round(n/5)*5; const max=rnd(w*(1+(0.033*r))); const rm5=rnd(max*0.87); const rm3=rnd(max*0.93);
    let html = `<div style="text-align:center; margin-bottom:20px; color:#2ed573; font-weight:bold; border:1px solid #333; padding:10px; border-radius:10px;">EST 1RM: ${max} LBS</div>`;
    const weeks = [{n:1,t:"BASE",b:rm5,m:.85,r:"5-6"},{n:2,t:"LOAD",b:rm5,m:.9,r:"5-6"},{n:3,t:"INTENSE",b:rm5,m:.95,r:"5-6"},{n:4,t:"PEAK",b:rm5,m:1.05,r:"5-6"},{n:5,t:"UNLOAD",b:rm5,m:.85,r:"2-4",f:.9},{n:6,t:"SPEED",b:rm3,m:1,r:"2-4",w:.75,f:.85},{n:7,t:"FORCE",b:rm3,m:1,r:"2-4",w:.85,f:.9},{n:8,t:"MAX",b:rm3,m:1,r:"2-3",w:.7,f:.85}];
    weeks.forEach(wk=>{ let m=rnd(wk.b*wk.m), wL=rnd(m*(wk.w||.85)), f=rnd(m*(wk.f||.95)); if(wk.n===4)wL=rnd(m*.8); html+=`<div class="week"><div class="week-head"><span>Week ${wk.n}</span><span style="color:#ff4757">${wk.t}</span></div>${row(wk.n, 'Mon', m, 'tag-h', 'H', wk.r)} ${row(wk.n, 'Wed', wL, 'tag-l', 'L', wk.r)} ${row(wk.n, 'Fri', f, 'tag-m', 'M', wk.r)}</div>`; });
    document.getElementById('schedule-area').innerHTML = html;
}
function row(wk, d, l, c, t, r) { const id = `w${wk}-${d}`; const done = localStorage.getItem(id) ? 'completed' : ''; return `<div class="day-row ${done}" id="row-${id}" onclick="tog('${id}')"><div style="display:flex;align-items:center"><span class="chk"></span><b>${d}</b></div><div><b>${l}x${r}</b><span class="tag ${c}">${t}</span></div></div>`; }
function tog(id) { const el = document.getElementById('row-'+id); if(el.classList.contains('completed')) { el.classList.remove('completed'); localStorage.removeItem(id); } else { el.classList.add('completed'); localStorage.setItem(id,'1'); } }
</script>
</body>
</html>
